<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
		<meta name="description" content="" />
		<meta name="author" content="" />
		<title>Percobaan</title>
	</head>
	<body>
		<div id="allBody">
			<h1 id="title">
				<a href="https://lazyudhowd.github.io/TestProject/">Mengambil Data dari Google SpreadSheets</a>
			</h1>
		<div id="footer">Copyright Â© 2024 <a href="https://lazismu-singkawang.business.site">Lazismu Kota Singkawang</a></div>

		<script type="text/javascript">
			// https://docs.google.com/spreadsheets/d/1Ilqf1q_f4UCprFt65EG-L-FovrO55u---x2-23w8Zhk/edit?usp=sharing
			let dataSpreadSheet = "https://docs.google.com/spreadsheets/d/1Ilqf1q_f4UCprFt65EG-L-FovrO55u---x2-23w8Zhk/gviz/tq?";

			fetch(dataSpreadSheet)
			.then(res => res.text())
			.then(retrieve => {
				// menampilkan data dari spreadsheet, sheet pertama
				console.log(retrieve);

				// memodifikasi data yang diambil dari spreadsheet menghilangkan bagian "google.visualization.Query.setResponse"
				// serta beberapa tanda kurung
				let parseData = retrieve.substr(47).slice(0,-2);
				console.log(" === after parsed ===");

				// menampilkan data yang telah di parsing
				console.log(parseData);

				// membuat objek json
				let jsonObject = JSON.parse(parseData);

				// menampilkan objek json
				console.log(jsonObject)
			})

		</script>
	</body>
</html>
